import argparse
import sys
import loguru
import os
import warnings
from rich.console import Console
from sspentestlab.utils.sspentestlab_gpt import sspentestlab

console = Console()

def main():
    """main function"""
    parser = argparse.ArgumentParser(description="SSPentestLab")

    # default log directory.
    parser.add_argument(
        "--log_dir",
        type=str,
        default="logs",
        help="path to the log directory, where conversations will be stored",
    )
    

    # reasoning model.
    parser.add_argument(
        "--reasoning_model",
        type=str,
        default="langollama",
        help="reasoning models are responsible for higher-level cognitive tasks, choose 'gpt-4' or 'gpt-4-turbo'",
    )
    
    
    # parsing model.
    parser.add_argument(
        "--parsing_model",
        type=str,
        default="langollama",
        help="parsing models deal with the structural and grammatical aspects of language, choose 'gpt-4-turbo' or 'gpt-3.5-turbo-16k'",
    )

    # set langfuse logging
    parser.add_argument(
        "--logging",
        action="store_true",
        default=False, # change to True incase want to set logging and set de keys in 'chatgpt_api.py'
        help="allow SSPentestLab developers to collect data through langfuse logging",
    )

    args = parser.parse_args()

    SSPentestLabSHandler = sspentestlab(
        reasoning_model=args.reasoning_model,
        parsing_model=args.parsing_model,
        log_dir=args.log_dir,
        use_langfuse_logging=args.logging,
    )

    # error handling for a smooth 'ctrl+c' console exit
    try:
        SSPentestLabSHandler.main()
    except:
        console.print("Thank you for your time, see you later!", style="yellow2")
        pass


if __name__ == "__main__":
    main()